{"ast":null,"code":"var _s = $RefreshSig$();\nimport { create } from \"zustand\";\nimport { fetchTrafficUpdatesData } from \"../services/apiService\";\nimport { useLocationStore } from \"./useLocationStore\";\n// import { TrafficState, TrafficUpdateInterface } from \"../types/trafficTypes\";\n\nexport const useTrafficStore = _s(create(_s(set => {\n  _s();\n  const location = useLocationStore(state => state.location);\n  const fetchTrafficUpdates = async () => {\n    try {\n      var _data$RESPONSE$RESULT;\n      console.log(\"Location in TrafficStore:\", location);\n      if (!location) {\n        console.error(\"Location is not set. Cannot fetch traffic updates.\");\n        return;\n      }\n      const {\n        latitude,\n        longitude\n      } = location;\n      console.log(\"Fetching traffic updates for:\", latitude, longitude);\n      const data = await fetchTrafficUpdatesData(latitude, longitude);\n      const situations = ((_data$RESPONSE$RESULT = data.RESPONSE.RESULT[0]) === null || _data$RESPONSE$RESULT === void 0 ? void 0 : _data$RESPONSE$RESULT.Situation) || [];\n      const extractedUpdates = situations.flatMap(situation => situation.Deviation.map(deviation => ({\n        MessageCode: deviation.MessageCode,\n        Message: deviation.Message,\n        SeverityText: deviation.SeverityText,\n        CreationTime: deviation.CreationTime,\n        LocationDescriptor: deviation.LocationDescriptor\n      })));\n      set({\n        trafficUpdates: extractedUpdates\n      });\n      console.log(\"Fetched traffic updates:\", extractedUpdates);\n    } catch (error) {\n      console.error(\"Failed to load data:\", error);\n    }\n  };\n  return {\n    trafficUpdates: [],\n    fetchTrafficUpdates\n  };\n}, \"V/AD95fmOi2fqj2q4BX4N668S44=\", false, function () {\n  return [useLocationStore];\n})), \"V/AD95fmOi2fqj2q4BX4N668S44=\", false, function () {\n  return [useLocationStore];\n});","map":{"version":3,"names":["create","fetchTrafficUpdatesData","useLocationStore","useTrafficStore","_s","set","location","state","fetchTrafficUpdates","_data$RESPONSE$RESULT","console","log","error","latitude","longitude","data","situations","RESPONSE","RESULT","Situation","extractedUpdates","flatMap","situation","Deviation","map","deviation","MessageCode","Message","SeverityText","CreationTime","LocationDescriptor","trafficUpdates"],"sources":["/Users/ida/VS-codeProjects/Local-Travel-And-Weather-Dashboard/my-app/src/store/useTrafficStore.tsx"],"sourcesContent":["import { create } from \"zustand\";\nimport { fetchTrafficUpdatesData } from \"../services/apiService\";\nimport { useLocationStore } from \"./useLocationStore\";\n// import { TrafficState, TrafficUpdateInterface } from \"../types/trafficTypes\";\n\nexport interface TrafficUpdate {\n  MessageCode: string;\n  Message: string;\n  SeverityText: string;\n  CreationTime: string;\n  LocationDescriptor: string;\n}\n\nexport interface TrafficState {\n    trafficUpdates: TrafficUpdate[];\n    fetchTrafficUpdates: () => Promise<void>;\n  }\n\n  export const useTrafficStore = create<TrafficState>((set) => {\n    const location = useLocationStore((state) => state.location);\n    const fetchTrafficUpdates = async () => {\n      try {\n        console.log(\"Location in TrafficStore:\", location);\n  \n        if (!location) {\n          console.error(\"Location is not set. Cannot fetch traffic updates.\");\n          return;\n        }\n  \n        const { latitude, longitude } = location;\n        console.log(\"Fetching traffic updates for:\", latitude, longitude);\n  \n        const data = await fetchTrafficUpdatesData(latitude, longitude);\n        const situations = data.RESPONSE.RESULT[0]?.Situation || [];\n  \n        const extractedUpdates: TrafficUpdate[] = situations.flatMap(\n          (situation: any) =>\n            situation.Deviation.map((deviation: any) => ({\n              MessageCode: deviation.MessageCode,\n              Message: deviation.Message,\n              SeverityText: deviation.SeverityText,\n              CreationTime: deviation.CreationTime,\n              LocationDescriptor: deviation.LocationDescriptor,\n            }))\n        );\n  \n        set({ trafficUpdates: extractedUpdates });\n  \n        console.log(\"Fetched traffic updates:\", extractedUpdates);\n      } catch (error) {\n        console.error(\"Failed to load data:\", error);\n      }\n    };\n  \n    return {\n      trafficUpdates: [],\n      fetchTrafficUpdates,\n    };\n  });\n"],"mappings":";AAAA,SAASA,MAAM,QAAQ,SAAS;AAChC,SAASC,uBAAuB,QAAQ,wBAAwB;AAChE,SAASC,gBAAgB,QAAQ,oBAAoB;AACrD;;AAeE,OAAO,MAAMC,eAAe,GAAAC,EAAA,CAAGJ,MAAM,CAAAI,EAAA,CAAgBC,GAAG,IAAK;EAAAD,EAAA;EAC3D,MAAME,QAAQ,GAAGJ,gBAAgB,CAAEK,KAAK,IAAKA,KAAK,CAACD,QAAQ,CAAC;EAC5D,MAAME,mBAAmB,GAAG,MAAAA,CAAA,KAAY;IACtC,IAAI;MAAA,IAAAC,qBAAA;MACFC,OAAO,CAACC,GAAG,CAAC,2BAA2B,EAAEL,QAAQ,CAAC;MAElD,IAAI,CAACA,QAAQ,EAAE;QACbI,OAAO,CAACE,KAAK,CAAC,oDAAoD,CAAC;QACnE;MACF;MAEA,MAAM;QAAEC,QAAQ;QAAEC;MAAU,CAAC,GAAGR,QAAQ;MACxCI,OAAO,CAACC,GAAG,CAAC,+BAA+B,EAAEE,QAAQ,EAAEC,SAAS,CAAC;MAEjE,MAAMC,IAAI,GAAG,MAAMd,uBAAuB,CAACY,QAAQ,EAAEC,SAAS,CAAC;MAC/D,MAAME,UAAU,GAAG,EAAAP,qBAAA,GAAAM,IAAI,CAACE,QAAQ,CAACC,MAAM,CAAC,CAAC,CAAC,cAAAT,qBAAA,uBAAvBA,qBAAA,CAAyBU,SAAS,KAAI,EAAE;MAE3D,MAAMC,gBAAiC,GAAGJ,UAAU,CAACK,OAAO,CACzDC,SAAc,IACbA,SAAS,CAACC,SAAS,CAACC,GAAG,CAAEC,SAAc,KAAM;QAC3CC,WAAW,EAAED,SAAS,CAACC,WAAW;QAClCC,OAAO,EAAEF,SAAS,CAACE,OAAO;QAC1BC,YAAY,EAAEH,SAAS,CAACG,YAAY;QACpCC,YAAY,EAAEJ,SAAS,CAACI,YAAY;QACpCC,kBAAkB,EAAEL,SAAS,CAACK;MAChC,CAAC,CAAC,CACN,CAAC;MAEDzB,GAAG,CAAC;QAAE0B,cAAc,EAAEX;MAAiB,CAAC,CAAC;MAEzCV,OAAO,CAACC,GAAG,CAAC,0BAA0B,EAAES,gBAAgB,CAAC;IAC3D,CAAC,CAAC,OAAOR,KAAK,EAAE;MACdF,OAAO,CAACE,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;IAC9C;EACF,CAAC;EAED,OAAO;IACLmB,cAAc,EAAE,EAAE;IAClBvB;EACF,CAAC;AACH,CAAC;EAAA,QAvCkBN,gBAAgB;AAAA,EAuClC,CAAC;EAAA,QAvCiBA,gBAAgB;AAAA,EAuCjC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}