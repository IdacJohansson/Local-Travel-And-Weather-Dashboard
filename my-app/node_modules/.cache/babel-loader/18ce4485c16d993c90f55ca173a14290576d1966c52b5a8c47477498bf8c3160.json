{"ast":null,"code":"import { create } from \"zustand\";\nimport { fetchTrafficUpdatesData } from \"../services/apiService\";\nimport { useLocationStore } from \"./useInputStore\";\nexport const useTrafficStore = create(set => ({\n  trafficUpdates: [],\n  fetchTrafficUpdates: async () => {\n    try {\n      var _data$RESPONSE$RESULT;\n      const {\n        location\n      } = useLocationStore.getState(); // Hämta platsdata\n      console.log(\"Location från store:\", location);\n      if (!location || typeof location !== \"string\") {\n        console.error(\"Location är tom eller undefined!\");\n        return;\n      }\n      const match = location.match(/Latitude:\\s*([-0-9.]+),\\s*Longitude:\\s*([-0-9.]+)/);\n      if (!match) {\n        console.error(\"Invalid location format:\", location);\n        return;\n      }\n      const latitude = parseFloat(match[1]);\n      const longitude = parseFloat(match[2]);\n      const data = await fetchTrafficUpdatesData(latitude, longitude);\n      const situations = ((_data$RESPONSE$RESULT = data.RESPONSE.RESULT[0]) === null || _data$RESPONSE$RESULT === void 0 ? void 0 : _data$RESPONSE$RESULT.Situation) || [];\n      const extractNestedData = situations.flatMap(situation => situation.Deviation.map(deviation => ({\n        MessageCode: deviation.MessageCode,\n        Message: deviation.Message,\n        SeverityText: deviation.SeverityText,\n        CreationTime: deviation.CreationTime,\n        LocationDescriptor: deviation.LocationDescriptor,\n        IconId: deviation.roadAccident\n      })));\n      set({\n        trafficUpdates: extractNestedData\n      });\n      console.log(extractNestedData);\n    } catch (error) {\n      console.error(\"Failed to load data:\", error);\n    }\n  }\n}));","map":{"version":3,"names":["create","fetchTrafficUpdatesData","useLocationStore","useTrafficStore","set","trafficUpdates","fetchTrafficUpdates","_data$RESPONSE$RESULT","location","getState","console","log","error","match","latitude","parseFloat","longitude","data","situations","RESPONSE","RESULT","Situation","extractNestedData","flatMap","situation","Deviation","map","deviation","MessageCode","Message","SeverityText","CreationTime","LocationDescriptor","IconId","roadAccident"],"sources":["/Users/ida/VS-codeProjects/Local-Travel-And-Weather-Dashboard/my-app/src/store/useTrafficStore.tsx"],"sourcesContent":["import { create } from \"zustand\";\nimport { fetchTrafficUpdatesData } from \"../services/apiService\";\nimport { useLocationStore } from \"./useInputStore\";\nimport { TrafficState, TrafficUpdateInterface } from \"../types/trafficTypes\";\n\nexport const useTrafficStore = create<TrafficState>((set) => ({\n  trafficUpdates: [],\n  fetchTrafficUpdates: async () => {\n    try {\n      const { location } = useLocationStore.getState(); // Hämta platsdata\n      console.log(\"Location från store:\", location);\n\n      if (!location || typeof location !== \"string\") {\n        console.error(\"Location är tom eller undefined!\");\n        return;\n      }\n\n      const match = location.match(/Latitude:\\s*([-0-9.]+),\\s*Longitude:\\s*([-0-9.]+)/);\n      if (!match) {\n        console.error(\"Invalid location format:\", location);\n        return;\n      }\n      const latitude = parseFloat(match[1]);\n      const longitude = parseFloat(match[2]);\n\n      const data = await fetchTrafficUpdatesData(latitude, longitude);\n      const situations = data.RESPONSE.RESULT[0]?.Situation || [];\n\n      const extractNestedData: TrafficUpdateInterface[] = situations.flatMap(\n        (situation: any) =>\n          situation.Deviation.map((deviation: any) => ({\n            MessageCode: deviation.MessageCode,\n            Message: deviation.Message,\n            SeverityText: deviation.SeverityText,\n            CreationTime: deviation.CreationTime,\n            LocationDescriptor: deviation.LocationDescriptor,\n            IconId: deviation.roadAccident\n          }))\n      );\n\n      set({ trafficUpdates: extractNestedData });\n\n      console.log(extractNestedData);\n    } catch (error) {\n      console.error(\"Failed to load data:\", error);\n    }\n  },\n}));\n"],"mappings":"AAAA,SAASA,MAAM,QAAQ,SAAS;AAChC,SAASC,uBAAuB,QAAQ,wBAAwB;AAChE,SAASC,gBAAgB,QAAQ,iBAAiB;AAGlD,OAAO,MAAMC,eAAe,GAAGH,MAAM,CAAgBI,GAAG,KAAM;EAC5DC,cAAc,EAAE,EAAE;EAClBC,mBAAmB,EAAE,MAAAA,CAAA,KAAY;IAC/B,IAAI;MAAA,IAAAC,qBAAA;MACF,MAAM;QAAEC;MAAS,CAAC,GAAGN,gBAAgB,CAACO,QAAQ,CAAC,CAAC,CAAC,CAAC;MAClDC,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAEH,QAAQ,CAAC;MAE7C,IAAI,CAACA,QAAQ,IAAI,OAAOA,QAAQ,KAAK,QAAQ,EAAE;QAC7CE,OAAO,CAACE,KAAK,CAAC,kCAAkC,CAAC;QACjD;MACF;MAEA,MAAMC,KAAK,GAAGL,QAAQ,CAACK,KAAK,CAAC,mDAAmD,CAAC;MACjF,IAAI,CAACA,KAAK,EAAE;QACVH,OAAO,CAACE,KAAK,CAAC,0BAA0B,EAAEJ,QAAQ,CAAC;QACnD;MACF;MACA,MAAMM,QAAQ,GAAGC,UAAU,CAACF,KAAK,CAAC,CAAC,CAAC,CAAC;MACrC,MAAMG,SAAS,GAAGD,UAAU,CAACF,KAAK,CAAC,CAAC,CAAC,CAAC;MAEtC,MAAMI,IAAI,GAAG,MAAMhB,uBAAuB,CAACa,QAAQ,EAAEE,SAAS,CAAC;MAC/D,MAAME,UAAU,GAAG,EAAAX,qBAAA,GAAAU,IAAI,CAACE,QAAQ,CAACC,MAAM,CAAC,CAAC,CAAC,cAAAb,qBAAA,uBAAvBA,qBAAA,CAAyBc,SAAS,KAAI,EAAE;MAE3D,MAAMC,iBAA2C,GAAGJ,UAAU,CAACK,OAAO,CACnEC,SAAc,IACbA,SAAS,CAACC,SAAS,CAACC,GAAG,CAAEC,SAAc,KAAM;QAC3CC,WAAW,EAAED,SAAS,CAACC,WAAW;QAClCC,OAAO,EAAEF,SAAS,CAACE,OAAO;QAC1BC,YAAY,EAAEH,SAAS,CAACG,YAAY;QACpCC,YAAY,EAAEJ,SAAS,CAACI,YAAY;QACpCC,kBAAkB,EAAEL,SAAS,CAACK,kBAAkB;QAChDC,MAAM,EAAEN,SAAS,CAACO;MACpB,CAAC,CAAC,CACN,CAAC;MAED9B,GAAG,CAAC;QAAEC,cAAc,EAAEiB;MAAkB,CAAC,CAAC;MAE1CZ,OAAO,CAACC,GAAG,CAACW,iBAAiB,CAAC;IAChC,CAAC,CAAC,OAAOV,KAAK,EAAE;MACdF,OAAO,CAACE,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;IAC9C;EACF;AACF,CAAC,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}